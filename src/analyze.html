<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analyze Music - EthnoMusic Lab GY</title>
  <meta name="theme-color" content="#667eea" />
  <link rel="manifest" href="manifest.json" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <header class="header">
    <div class="container">
      <h1>ğŸµ EthnoMusic Lab GY</h1>
      <nav>
        <a href="index.html" class="nav-link">Explore</a>
        <a href="analyze.html" class="nav-link active">Analyze</a>
        <a href="learn.html" class="nav-link">Learn & Play</a>
        <a href="create.html" class="nav-link">Create Music</a>
        <a href="educators.html" class="nav-link">For Educators</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <h2 style="color: #000 !important;">ğŸµ Analyze Musical Patterns</h2>
    
    <div class="info-banner">
      <p>ğŸŒ Interested in digital heritage and cultural analysis? <a href="https://www.digitalheritagegy.com" target="_blank">Visit Digital Heritage GY â†’</a></p>
    </div>
    
    <div class="upload-section">
      <input type="file" id="file-input" accept=".wav,.ogg,.flac,.mp3,.m4a,.weba,.webm"/>
      <label for="file-input" class="btn-primary">ğŸ“ Upload Audio File</label>
      <p class="help-text">Upload audio (WAV, OGG, FLAC recommended â€¢ MP3/M4A have limited support)</p>
      <button id="cancel-analysis" class="btn-secondary" style="display:none;">âœ–ï¸ Cancel Analysis</button>
    </div>

    <div id="analysis-results" style="display:none;">
      <!-- Audio Info Summary -->
      <div class="summary-panel">
        <div class="summary-header">ğŸ“Š Analysis Summary</div>
        <div class="summary-grid">
          <div class="summary-stat">
            <span class="stat-label">Duration</span>
            <span class="stat-value" id="audio-duration">--</span>
          </div>
          <div class="summary-stat">
            <span class="stat-label">Sample Rate</span>
            <span class="stat-value" id="audio-sample-rate">--</span>
          </div>
          <div class="summary-stat">
            <span class="stat-label">Detected BPM</span>
            <span class="stat-value" id="audio-bpm">--</span>
          </div>
          <div class="summary-stat">
            <span class="stat-label">Scale/Key</span>
            <span class="stat-value" id="audio-key">--</span>
          </div>
          <div class="summary-stat">
            <span class="stat-label">Brightness</span>
            <span class="stat-value" id="audio-brightness">--</span>
          </div>
          <div class="summary-stat">
            <span class="stat-label">Complexity</span>
            <span class="stat-value" id="audio-complexity">--</span>
          </div>
        </div>
      </div>

      <!-- Download Controls -->
      <div class="download-panel">
        <div class="download-header">ğŸ“¥ Download Results</div>
        <div class="download-buttons">
          <button id="download-pitch-chart" class="btn-download">Pitch Chart</button>
          <button id="download-rhythm-chart" class="btn-download">Rhythm Chart</button>
          <button id="download-spectral-chart" class="btn-download">Spectral Chart</button>
          <button id="download-melodic-chart" class="btn-download">Melodic Chart</button>
          <button id="download-waveform-chart" class="btn-download">Waveform</button>
          <button id="download-analysis-data" class="btn-download-data">JSON Data</button>
          <button id="download-full-report" class="btn-download-data">Text Report</button>
        </div>
      </div>

      <!-- Analysis Charts Grid -->
      <div class="charts-section">
        <h3 style="text-align: center; margin: 20px 0 15px; color: #333;">ğŸ“ˆ Detailed Analysis</h3>
        <div class="analysis-grid">
          <div class="analysis-card">
            <h3>ğŸŒŠ Waveform</h3>
            <canvas id="waveform-chart" width="400" height="200"></canvas>
            <div id="waveform-info" style="font-size: 12px; color: #666; margin-top: 10px;"></div>
          </div>
          <div class="analysis-card">
            <h3>ğŸšï¸ Pitch Analysis</h3>
            <canvas id="pitch-chart" width="400" height="300"></canvas>
            <div id="pitch-info"></div>
          </div>
          <div class="analysis-card">
            <h3>ğŸ¥ Rhythm Analysis</h3>
            <canvas id="rhythm-chart" width="400" height="300"></canvas>
            <div id="rhythm-info"></div>
          </div>
          <div class="analysis-card">
            <h3>ğŸ¼ Spectral Features</h3>
            <canvas id="spectral-chart" width="400" height="300"></canvas>
            <div id="spectral-info"></div>
          </div>
          <div class="analysis-card">
            <h3>ğŸ“Š Melodic Frequency</h3>
            <canvas id="melodic-chart" width="400" height="300"></canvas>
            <div id="melodic-info"></div>
          </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <p>Created with â¤ï¸ by <strong>Rohan R. Sagar</strong> | <a href="https://www.digitalheritagegy.com" target="_blank">Digital Heritage GY</a></p>
  </footer>
</body>
</html>
